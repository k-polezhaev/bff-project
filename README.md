# Go API Gateway (Backend for Frontend)

![Go](https://img.shields.io/badge/Go-1.22+-00ADD8?style=flat&logo=go)  
![Docker](https://img.shields.io/badge/Docker-Compose-2496ED?style=flat&logo=docker)  
![Redis](https://img.shields.io/badge/Redis-Cache-DC382D?style=flat&logo=redis)  
![Prometheus](https://img.shields.io/badge/Prometheus-Monitoring-E6522C?style=flat&logo=prometheus)

–£—á–µ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—â–∏–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é¬†**API Gateway**¬†(–ø–∞—Ç—Ç–µ—Ä–Ω BFF) –Ω–∞ —è–∑—ã–∫–µ Go. –°–µ—Ä–≤–∏—Å –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤, –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—è –∫–ª–∏–µ–Ω—Ç—É –µ–¥–∏–Ω—ã–π API.

---
## –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏ –ú–µ—Ö–∞–Ω–∏–∑–º—ã

### 1. –ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (Concurrency)

–î–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–∫–ª–∏–∫–∞ –∑–∞–ø—Ä–æ—Å—ã –∫ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ.
- **–õ–æ–≥–∏–∫–∞:**¬†–°–Ω–∞—á–∞–ª–∞ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è –∫—Ä–∏—Ç–∏—á–Ω—ã–π¬†`User Service`. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–π–¥–µ–Ω, –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è¬†**Fan-out**: –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —É—Ö–æ–¥—è—Ç –∑–∞–ø—Ä–æ—Å—ã –∑–∞ –∑–∞–∫–∞–∑–∞–º–∏, –ø—Ä–æ–¥—É–∫—Ç–∞–º–∏ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏.
- **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**¬†–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è¬†`sync.WaitGroup`¬†–∏¬†**Goroutines**.
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:**¬†–í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ Gateway —Ä–∞–≤–Ω–æ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞¬†_—Å–∞–º–æ–≥–æ –º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ_¬†—Å–µ—Ä–≤–∏—Å–∞, –∞ –Ω–µ —Å—É–º–º–µ –≤—Å–µ—Ö –æ—Ç–≤–µ—Ç–æ–≤.

### 2. –û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å (Resilience)

#### Retry Mechanism 
–ü—Ä–µ–∂–¥–µ —á–µ–º –≤–µ—Ä–Ω—É—Ç—å –æ—à–∏–±–∫—É, Gateway –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–ø—Ä–æ—Å.
- **–ù–∞—Å—Ç—Ä–æ–π–∫–∞:**¬†3 –ø–æ–ø—ã—Ç–∫–∏.
- **–ó–∞–¥–µ—Ä–∂–∫–∞:**¬†500 –º—Å –º–µ–∂–¥—É –ø–æ–ø—ã—Ç–∫–∞–º–∏.
- **–£—Å–ª–æ–≤–∏–µ:**¬†–°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–∫–∞—Ö –∏–ª–∏ 5xx –∫–æ–¥–∞—Ö –æ—Ç–≤–µ—Ç–∞. –û—à–∏–±–∫–∏ 4xx –Ω–µ –ø–æ–≤—Ç–æ—Ä—è—é—Ç—Å—è.

#### Circuit Breaker 
–ó–∞—â–∏—â–∞–µ—Ç —Å–∏—Å—Ç–µ–º—É –æ—Ç –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏. –ï—Å–ª–∏ —Å–µ—Ä–≤–∏—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏) –ª–µ–∂–∏—Ç, –Ω–µ—Ç —Å–º—ã—Å–ª–∞ –¥–æ–ª–±–∏—Ç—å –µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞–º–∏ –∏ –∂–¥–∞—Ç—å —Ç–∞–π–º–∞—É—Ç–∞.
- **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**¬†–°–∞–º–æ–ø–∏—Å–Ω—ã–π –º–æ–¥—É–ª—å¬†`internal/resilience`.
- **–ü–æ—Ä–æ–≥ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è:**¬†3 –æ—à–∏–±–∫–∏ –ø–æ–¥—Ä—è–¥.
- **–¢–∞–π–º–∞—É—Ç —Å–±—Ä–æ—Å–∞:**¬†10 —Å–µ–∫—É–Ω–¥ (–ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ Half-Open –¥–ª—è –ø—Ä–æ–±–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞).
- **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**¬†–û–±–µ—Ä–Ω—É—Ç —Å–µ—Ä–≤–∏—Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π. –ï—Å–ª–∏ –æ–Ω –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∫–ª–∏–µ–Ω—Ç—É –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π, –Ω–æ –æ—Å–Ω–æ–≤–Ω–æ–π –æ—Ç–≤–µ—Ç –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è.

#### Timeouts
–î–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∑–∞–≤–∏—Å–∞–Ω–∏—è –≥–æ—Ä—É—Ç–∏–Ω –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –∂–µ—Å—Ç–∫–∏–µ —Ç–∞–π–º–∞—É—Ç—ã:
- **HTTP Client:**¬†5 —Å–µ–∫—É–Ω–¥ –Ω–∞ –≤–µ—Å—å –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –∑–∞–ø—Ä–æ—Å–∞.
- **Redis:**¬†5 —Å–µ–∫—É–Ω–¥ –Ω–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ.
### 3. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

####  Redis Caching
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–∞—Ç—Ç–µ—Ä–Ω¬†**Cache-Aside**.
- **–ö–ª—é—á:**¬†`profile:{userId}`.
- **TTL (–í—Ä–µ–º—è –∂–∏–∑–Ω–∏):**¬†30 —Å–µ–∫—É–Ω–¥.
- **–°—Ç—Ä–∞—Ç–µ–≥–∏—è:**¬†–ü—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è Redis. –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç, —Ç–æ –∏–¥–µ–º –≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã, —Å–æ–±–∏—Ä–∞–µ–º –æ—Ç–≤–µ—Ç, –æ—Ç–¥–∞–µ–º –∫–ª–∏–µ–Ω—Ç—É –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∫—ç—à.

#### Rate Limiting
- **–ê–ª–≥–æ—Ä–∏—Ç–º:**¬†Fixed Window Counter (–Ω–∞ –±–∞–∑–µ Redis).
- **–õ–∏–º–∏—Ç:**¬†10 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É —Å –æ–¥–Ω–æ–≥–æ IP.
- **–†–µ–∞–∫—Ü–∏—è:**¬†–í–æ–∑–≤—Ä–∞—Ç¬†`429 Too Many Requests`.

### 4. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (JWT)

- **Middleware:**¬†–ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å.
- **–í–∞–ª–∏–¥–∞—Ü–∏—è:**¬†–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏¬†`HS256`¬†–∏ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è (`exp`).
- **–ò–∑–æ–ª—è—Ü–∏—è:**¬†–°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –ø—Ä–æ–∫–∏–¥—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è, –Ω–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –∫–æ–¥–µ.

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç —Å–ª–µ–¥—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É¬†**Standard Go Project Layout**, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –º–æ–¥—É–ª—å–Ω–æ—Å—Ç—å –∏ —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å.

```
‚îú‚îÄ‚îÄ cmd                       # –¢–æ—á–∫–∏ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ api-gateway           # –û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å (Gateway/BFF)
‚îÇ   ‚îú‚îÄ‚îÄ order-service         # –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –∑–∞–∫–∞–∑–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ product-service       # –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å —Ç–æ–≤–∞—Ä–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ user-service          # –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îú‚îÄ‚îÄ deploy                    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
‚îÇ   ‚îî‚îÄ‚îÄ prometheus            # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫ (prometheus.yml)
‚îú‚îÄ‚îÄ internal                  # –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–æ–¥ (–ª–æ–≥–∏–∫–∞ Gateway)
‚îÇ   ‚îú‚îÄ‚îÄ api                   # HTTP Handlers (—Å–±–æ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤, –≤–∞–ª–∏–¥–∞—Ü–∏—è)
‚îÇ   ‚îú‚îÄ‚îÄ auth                  # Middleware: JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ cache                 # –ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è –Ω–∞–¥ Redis (Cache-Aside, Rate Limit)
‚îÇ   ‚îú‚îÄ‚îÄ config                # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π (ENV)
‚îÇ   ‚îú‚îÄ‚îÄ models                # DTO (Data Transfer Objects)
‚îÇ   ‚îú‚îÄ‚îÄ resilience            # –ü–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ (Circuit Breaker, Retry)
‚îÇ   ‚îú‚îÄ‚îÄ services              # HTTP-–∫–ª–∏–µ–Ω—Ç—ã –∫ –≤–Ω–µ—à–Ω–∏–º –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º
‚îÇ   ‚îî‚îÄ‚îÄ telemetry             # Middleware: –ú–µ—Ç—Ä–∏–∫–∏ Prometheus
‚îú‚îÄ‚îÄ docker-compose.yml        # –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –≤—Å–µ–≥–æ —Å—Ç–µ–∫–∞
‚îî‚îÄ‚îÄ go.mod                    # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
```

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Docker & Docker Compose
### –ó–∞–ø—É—Å–∫
1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
    ```
    git clone https://github.com/your-username/bff-project.git
    ```
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å—Ç–µ–∫:
    ```
    docker-compose up --build
    ```
### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API

–°–µ—Ä–≤–∏—Å –∑–∞—â–∏—â–µ–Ω. –î–ª—è —Ç–µ—Å—Ç–∞ –Ω—É–∂–µ–Ω JWT —Ç–æ–∫–µ–Ω, –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π –∫–ª—é—á–æ–º¬†`super-secret-key`.

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```
# –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª—è ID 123
curl -v -H "Authorization: Bearer <YOUR_VALID_TOKEN>" http://localhost:8080/api/profile/123
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ Observability

–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è Prometheus.
1. **Prometheus**¬†(`http://localhost:9090`)
    - –°–∫—Ä–µ–π–ø–∏—Ç –º–µ—Ç—Ä–∏–∫–∏ —Å —Å–µ—Ä–≤–∏—Å–∞ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥.
    - –î–æ—Å—Ç—É–ø–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏:¬†`http_requests_total`,¬†`http_request_duration_seconds`.

2. **Grafana**¬†(`http://localhost:3000`)
    - –õ–æ–≥–∏–Ω/–ü–∞—Ä–æ–ª—å:¬†`admin`¬†/¬†`admin`.
    - –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è RPS –∏ Latency –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (Environment Variables)

–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—ã–Ω–µ—Å–µ–Ω—ã –≤¬†`docker-compose.yml`:

|–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è|–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é|–û–ø–∏—Å–∞–Ω–∏–µ|
|---|---|---|
|`HTTP_PORT`|8080|–ü–æ—Ä—Ç –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–∞|
|`REDIS_ADDR`|redis:6379|–ê–¥—Ä–µ—Å Redis|
|`JWT_SECRET`|super-secret-key|–°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ —Ç–æ–∫–µ–Ω–æ–≤|
|`USER_SERVICE_URL`|[http://mock:8081](http://mock:8081/)|URL —Å–µ—Ä–≤–∏—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π|
|`ORDER_SERVICE_URL`|[http://mock:8082](http://mock:8082/)|URL —Å–µ—Ä–≤–∏—Å–∞ –∑–∞–∫–∞–∑–æ–≤|

